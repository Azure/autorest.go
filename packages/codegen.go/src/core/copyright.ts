/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/

/**
 * Regular expression that matches the Go "DO NOT EDIT" comment pattern.
 * Used by tools to identify generated files.
 * See: https://pkg.go.dev/cmd/go#hdr-Generate_Go_files_by_processing_source
 */
export const doNotEditRegex = /^\/\/ Code generated .* DO NOT EDIT\.$/m;

/**
 * Ensures the copyright text contains 'DO NOT EDIT.' on the same line as 'Code generated'
 * to match the format expected by cleanup tools.
 *
 * @param text the raw copyright text (already formatted as comments)
 * @returns the copyright text with 'DO NOT EDIT.' properly placed
 */
export function ensureDoNotEdit(text: string): string {
  // ensure tools recognize the file as generated according to
  // https://pkg.go.dev/cmd/go#hdr-Generate_Go_files_by_processing_source
  let result = text.replace(/^\/\/ Code generated .*\.$/m, '$& DO NOT EDIT.');
  if (!result.match(doNotEditRegex)) {
    result += '\n// Code generated by @autorest/go. DO NOT EDIT.';
  }
  return result;
}
